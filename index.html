<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CAG Runway GPS Tracker</title>
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>
  <header>
    <h2>CAG</h2>
    <h3>Runway GPS Tracker</h3>
  </header>

  <main>
    <section class="card">
      <h2>Create New Tracking Session</h2>
      <p>Click the button to generate a unique session ID and QR code. Personnel will scan this QR to join the GPS tracking session.</p>

      <button id="newSessionBtn">Generate New Session</button>

      <p><strong>Session ID:</strong> <span id="sessionDisplay">-</span></p>
      <p><strong>Join URL:</strong> <span id="joinUrlDisplay">-</span></p>

      <div id="qrContainer"></div>
    </section>

    <section class="card">
      <h2>Admin Dashboard</h2>
      <p>Monitor all tracked personnel and vehicles in real-time.</p>
      <a href="admin.html" class="button">Open Admin Dashboard</a>
    </section>
  </main>

  <!-- JS for QR generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>

  <!-- PAGE LOGIC -->
  <script>
    document.getElementById("newSessionBtn").addEventListener("click", () => {
      const sessionId = "sess-" + Math.random().toString(36).substring(2, 10);
      const url = `https://allinton6.github.io/GPS-tracker/track.html?session=${sessionId}`;

      document.getElementById("sessionDisplay").textContent = sessionId;
      document.getElementById("joinUrlDisplay").textContent = url;

      const qr = new QRious({
        element: document.createElement("canvas"),
        value: url,
        size: 250,
      });

      const qrContainer = document.getElementById("qrContainer");
      qrContainer.innerHTML = "";
      qrContainer.appendChild(qr.element);
    });
  </script>
</body>
</html>
